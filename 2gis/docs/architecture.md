Архитектура

Верхний уровень
- Приложение на SwiftUI с общим состоянием в AppModel.
- ContentView собирает секции UI: статус GPS, демо навигации, оверлей маршрута (Canvas) и простой поиск по координатам.
- Окна билбордов реализованы как дополнительная WindowGroup с ключом по значению ManeuverNode.

Поток данных
- Пользователь инициирует построение маршрута → NavigationViewModel вызывает 2GIS → ContentView извлекает узлы манёвров и полную полилинию → AppModel сохраняет их.
- При каждом обновлении локации → ContentView вычисляет прогресс по полилинии и обновляет отображаемый билборд.
- При смене маршрута → ранее открытые окна закрываются по сохранённым значениям; создаются новые билборды.

Компоненты
- AppModel: центральное состояние для оверлея маршрута, позиции/прогресса пользователя и учёта открытых окон.
- NavigationViewModel: асинхронные вызовы API и фоновая задача непрерывного map matching.
- LocationService: обёртка CoreLocation; умеет переключаться между реальным GPS и GPX‑моком.
- NavigationAPIClient: HTTP‑клиент с JSON‑кодеками, прод‑базами и типизированными моделями.
- RouteOverlayModels: типы данных (ManeuverNode, GeoPoint, RoutePolyline) и гео‑утилиты.
- SignpostWindow: компактная карточка с подсказкой и опциональной дистанцией.
- ContentView: связывает всё вместе, рисует Canvas‑оверлей, открывает/закрывает окна билбордов.

Обработка ошибок
- ViewModel’и собирают и показывают сообщения об ошибках там, где это уместно.
- Сетевой клиент явно сообщает об ошибках HTTP и декодирования.

Конкурентность
- Async/await; долгоживущие циклы (например, map matching) выполняются в Task и отменяются при уходе экрана.
